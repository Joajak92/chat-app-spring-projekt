Entiteter:

- User
- Message
- Profile
- Comment
- Tag


Attribut:

User
- användarnamn
- lösenord

Message
- ämne
- text
- tidsmärkning

Profile
- bild-url
- beskrivning

Comment
- text
- tidsmärkning

tag
- tag-namn


User - Message (1-*)
User - Comment (1-*)
User - Profile (1-1)
Message - Comment (1-*)
Message - Tag (-)

Krav:

User kan skriva message: ja
User kan skriva comment: ja
User har en profil med bild och beskrivning: ja
Message kan ha en tag: ja


Logisk utgångspunkt:

User 1-* Message
User 1-* Comment
User 1-1 Profile
Message 1-* Comment
Message *-* Tag


User
- id (PK)
- username
- password

Message
- id (PK)
- subject
- text
- timestamp
- user_id (FK)

Profile
- id (PK)
- image_url
- description
- user_id (FK)

Comment
- id (PK)
- text
- timestamp
- user_id (FK)
- message_id (FK)

Tag
- name (PK)

MessageTag
- message_id (FK)
- tag_name (FK)


Full logisk modell:

User(id, username, password)
Message(id, text, subject, timestamp, user_id)
Profile(id, image_url, description, user_id)
Comment(id, text, timestamp, user_id, message_id)
Tag(name)
MessageTag(message_id, tag_name)


Fysisk modell:


CREATE TABLE users (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(30) NOT NULL UNIQUE,
    password VARCHAR(100) NOT NULL
);

CREATE TABLE messages (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    subject VARCHAR(500) NOT NULL,
    text VARCHAR(1000) NOT NULL,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_messages_users
        FOREIGN KEY (user_id)
        REFERENCES users(id)
);

CREATE TABLE profiles (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    image_url VARCHAR(500),
    description TEXT,
    user_id BIGINT NOT NULL,
    CONSTRAINT fk_profiles_users
        FOREIGN KEY (user_id)
        REFERENCES users(id)
);

CREATE TABLE comments (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    message_id BIGINT NOT NULL,
    text VARCHAR(1000) NOT NULL,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_comments_users
        FOREIGN KEY (user_id)
        REFERENCES users(id),
    CONSTRAINT fk_comments_messages
        FOREIGN KEY (message_id)
        REFERENCES messages(id)
);

CREATE TABLE tags (
    name VARCHAR(40) PRIMARY KEY NOT NULL,
);

CREATE TABLE message_tags (
    message_id BIGINT NOT NULL,
    tag_name VARCHAR(40) NOT NULL,
    PRIMARY KEY (message_id, tag_name),
    FOREIGN KEY (message_id) REFERENCES messages(id),
    FOREIGN KEY (tag_name) REFERENCES tags(name)
);




